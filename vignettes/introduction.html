<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Michael Schramm" />

<meta name="date" content="2019-02-02" />

<title>Introduction to echor</title>

<script>$(document).ready(function(){
    if (typeof $('[data-toggle="tooltip"]').tooltip === 'function') {
        $('[data-toggle="tooltip"]').tooltip();
    }
    if ($('[data-toggle="popover"]').popover === 'function') {
        $('[data-toggle="popover"]').popover();
    }
});
</script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; position: absolute; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; }
pre.numberSource a.sourceLine:empty
  { position: absolute; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: absolute; left: -5em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#header {
text-align: center;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; }  code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>

</head>

<body>




<h1 class="title toc-ignore">Introduction to echor</h1>
<h4 class="author"><em>Michael Schramm</em></h4>
<h4 class="date"><em>2019-02-02</em></h4>



<div id="echor-introduction" class="section level2">
<h2>echor introduction</h2>
<p><code>echor</code> is an R package to search and download data from the US Environmental Protection Agency (EPA) Environmental Compliance and History Online (ECHO). <code>echor</code> uses the <a href="https://echo.epa.gov/">ECHO API</a> to download data directly to the R as dataframes or simple features. ECHO provides information about facilities permitted to emitted air pollutants or discharge into water bodies. ECHO also provides data reported by permitted facilites as volume or concentration of pollutants during reporting time periods (typically anually for air emissions and monthly or quarterly for water discharges).</p>
<p>ECHO provides data for:</p>
<ul>
<li>Stationary sources permitted under the Clean Air Act, including data from the National Emissions Inventory, Greenhouse Gas Reporting Program, Toxics Release Inventory, and Clean Air Markets Division Acid Rain Program and Clean Air Interstate Rule.</li>
<li>Public drinking water systems permitted under the Safe Drinking Water Act, including data from the Safe Drinking Water Information System.</li>
<li>Hazardous Waste Handlers permitted under the Resource Conservation and Recovery Act, with data drawn from the RCRAInfo data system.</li>
<li>Facilities permitted under the Clean Water Act and the National Pollutant Discharge Elimination Systems (NPDES) program, including data from EPA’s ICIS-NPDES system and possibly waterbody information from EPA’s ATTAINS data system.</li>
</ul>
<p><code>echor</code> currently provides functions to retrieve information about permitted air dischargers, water dischargers, and public drinking water supply systems. It also provides functions to download discharge reports for permitted air and water dischargers. <code>echor</code> does not currently provide functionality to retrieve RCRA data.</p>
<p>See <a href="https://echo.epa.gov/tools/web-services" class="uri">https://echo.epa.gov/tools/web-services</a> for information about ECHO web services and API functions.</p>
</div>
<div id="getting-started" class="section level2">
<h2>Getting started</h2>
<p>This vignette documents a few key functions to get started.</p>
<p>There are three types of functions:</p>
<div id="metadata" class="section level3">
<h3>Metadata</h3>
<p>Retrieve metadata from ECHO to narrow the specify data returned or lookup parameter codes.</p>
<ul>
<li><p><code>echoAirGetMeta()</code> - Returns variable name and descriptions for paramaters returned in air facility queries.</p></li>
<li><p><code>echoSDWGetMeta()</code> - Returns variable name and descriptions for parameters returned in public water system queries.</p></li>
<li><p><code>echoWaterGetMeta()</code> - Returns varaiable name and descriptions for parameters returned in water discharge facility queries (e.g. facilities with an NPDES permit).</p></li>
<li><p><code>echoWaterGetParams()</code> - Search parameter codes for constiuent pollutants regulated under NPDES permits.</p></li>
</ul>
</div>
<div id="query-facilities" class="section level3">
<h3>Query Facilities</h3>
<p>Search and return facility information based on lookup parameters.</p>
<ul>
<li><p><code>echoAirGetFacilityInfo()</code> - Returns a dataframe of permitted air discharge facilities and associated information based on lookup parameters specified by the user.</p></li>
<li><p><code>echoSDWGetSystems()</code> - Returns a dataframe of permitted air discharge facilities and associated information based on lookup parameters specified by the user.</p></li>
<li><p><code>echoWaterGetFacilityInfo()</code> - Returns a dataframe of permitted water discharge facilities and associated information based on lookup parameters specified by the user.</p></li>
</ul>
</div>
<div id="reports" class="section level3">
<h3>Reports</h3>
<p>Search and return discharge and emissions reports for specified facilities.</p>
<ul>
<li><p><code>echoGetCAAPR()</code> - Returns a dataframe with reported annual air emissions from permitted facilities.</p></li>
<li><p><code>echoGetEffluent()</code> - Returns a dataframe with reported water effluent discharges from permitted facilities.</p></li>
</ul>
</div>
</div>
<div id="sample-workflows" class="section level2">
<h2>Sample workflows</h2>
<div id="air" class="section level3">
<h3>Air</h3>
<p>Suppose we want to find facilities permitted under the Clean Air Act requirements.</p>
<p>Step 1 - Identify the information we need returned from the query:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw">library</span>(echor)</a>
<a class="sourceLine" id="cb1-2" data-line-number="2">meta &lt;-<span class="st"> </span><span class="kw">echoAirGetMeta</span>()</a>
<a class="sourceLine" id="cb1-3" data-line-number="3">meta</a>
<a class="sourceLine" id="cb1-4" data-line-number="4"><span class="co">#&gt; # A tibble: 131 x 6</span></a>
<a class="sourceLine" id="cb1-5" data-line-number="5"><span class="co">#&gt;    ColumnName  DataType DataLength ColumnID ObjectName  Description       </span></a>
<a class="sourceLine" id="cb1-6" data-line-number="6"><span class="co">#&gt;    &lt;chr&gt;       &lt;chr&gt;    &lt;chr&gt;      &lt;chr&gt;    &lt;chr&gt;       &lt;chr&gt;             </span></a>
<a class="sourceLine" id="cb1-7" data-line-number="7"><span class="co">#&gt;  1 AIR_NAME    VARCHAR2 200        1        AIRName     The name of the A~</span></a>
<a class="sourceLine" id="cb1-8" data-line-number="8"><span class="co">#&gt;  2 SOURCE_ID   VARCHAR2 30         2        SourceID    Unique Identifier~</span></a>
<a class="sourceLine" id="cb1-9" data-line-number="9"><span class="co">#&gt;  3 AIR_STREET  VARCHAR2 200        3        AIRStreet   The street addres~</span></a>
<a class="sourceLine" id="cb1-10" data-line-number="10"><span class="co">#&gt;  4 AIR_CITY    VARCHAR2 100        4        AIRCity     &lt;NA&gt;              </span></a>
<a class="sourceLine" id="cb1-11" data-line-number="11"><span class="co">#&gt;  5 AIR_STATE   CHAR     2          5        AIRState    The state where t~</span></a>
<a class="sourceLine" id="cb1-12" data-line-number="12"><span class="co">#&gt;  6 LOCAL_CONT~ CHAR     3          6        LocalContr~ Code for regions ~</span></a>
<a class="sourceLine" id="cb1-13" data-line-number="13"><span class="co">#&gt;  7 AIR_ZIP     VARCHAR2 10         7        AIRZip      The five-digit zi~</span></a>
<a class="sourceLine" id="cb1-14" data-line-number="14"><span class="co">#&gt;  8 REGISTRY_ID VARCHAR2 50         8        RegistryID  An internal 12-di~</span></a>
<a class="sourceLine" id="cb1-15" data-line-number="15"><span class="co">#&gt;  9 AIR_COUNTY  VARCHAR2 100        9        AIRCounty   The name of the c~</span></a>
<a class="sourceLine" id="cb1-16" data-line-number="16"><span class="co">#&gt; 10 AIR_EPA_RE~ CHAR     2          10       AIREPARegi~ The EPA region wh~</span></a>
<a class="sourceLine" id="cb1-17" data-line-number="17"><span class="co">#&gt; # ... with 121 more rows</span></a></code></pre></div>
<p>The dataframe includes ColumnID, which can be included as an argument that specifies what information you want returned: <code>qcolumns = &quot;1,2,3,22,23&quot;</code></p>
<p>Step 2 - Create the query. The ECHO API provides numerous arguments to search by that are not documented in this package. I reccomend exploring the documentation here: <a href="https://echo.epa.gov/tools/web-services/facility-search-air#!/Facilities/get_air_rest_services_get_facility_info" class="uri">https://echo.epa.gov/tools/web-services/facility-search-air#!/Facilities/get_air_rest_services_get_facility_info</a>. In this example, we will search by a geographic bounding box and specfiy the returned information with the <code>qcolumns</code> argument. Each argument should be passeed to ECHO as <code>echoAirGetFacilityInfo(parameter = &quot;value&quot;)</code>. <code>echor</code> will URL encode strings automatically. Please note that any date argument needs to be entered as “mm/dd/yyyy”.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="kw">library</span>(echor)</a>
<a class="sourceLine" id="cb2-2" data-line-number="2"></a>
<a class="sourceLine" id="cb2-3" data-line-number="3">## Retrieve information about facilities within a geographic location</a>
<a class="sourceLine" id="cb2-4" data-line-number="4">df &lt;-<span class="st"> </span><span class="kw">echoAirGetFacilityInfo</span>(<span class="dt">output =</span> <span class="st">&quot;df&quot;</span>,</a>
<a class="sourceLine" id="cb2-5" data-line-number="5">                             <span class="dt">xmin =</span> <span class="st">'-96.387509'</span>,</a>
<a class="sourceLine" id="cb2-6" data-line-number="6">                             <span class="dt">ymin =</span> <span class="st">'30.583572'</span>,</a>
<a class="sourceLine" id="cb2-7" data-line-number="7">                             <span class="dt">xmax =</span> <span class="st">'-96.281422'</span>,</a>
<a class="sourceLine" id="cb2-8" data-line-number="8">                             <span class="dt">ymax =</span> <span class="st">'30.640008'</span>,</a>
<a class="sourceLine" id="cb2-9" data-line-number="9">                             <span class="dt">qcolumns =</span> <span class="st">&quot;1,2,3,22,23&quot;</span>)</a></code></pre></div>
<div style="border: 1px solid #ddd; padding: 5px; overflow-y: scroll; height:200px; overflow-x: scroll; width:500px; ">
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
AIRName
</th>
<th style="text-align:left;">
SourceID
</th>
<th style="text-align:left;">
AIRStreet
</th>
<th style="text-align:right;">
FacLat
</th>
<th style="text-align:right;">
FacLong
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
AGGIE CLEANERS
</td>
<td style="text-align:left;">
06000000480416E020
</td>
<td style="text-align:left;">
111 COLLEGE MAIN
</td>
<td style="text-align:right;">
30.61869
</td>
<td style="text-align:right;">
-96.34588
</td>
</tr>
<tr>
<td style="text-align:left;">
ALL SEASONS 1 HR CLEANERS
</td>
<td style="text-align:left;">
06000000480416E015
</td>
<td style="text-align:left;">
2501 TEXAS AVENUE SOUTH #D100
</td>
<td style="text-align:right;">
30.60704
</td>
<td style="text-align:right;">
-96.30875
</td>
</tr>
<tr>
<td style="text-align:left;">
BLUEBONNET PAVING
</td>
<td style="text-align:left;">
TX0000004877700147
</td>
<td style="text-align:left;">
HWY. 60, WEST OF
</td>
<td style="text-align:right;">
30.61337
</td>
<td style="text-align:right;">
-96.32098
</td>
</tr>
<tr>
<td style="text-align:left;">
BRAZOS PAVING TRENCH BURNER IN1633
</td>
<td style="text-align:left;">
TX0000004877702288
</td>
<td style="text-align:left;">
TURN S ON VICTORIA AVE OFF OF HWY 40 TAKE A R ON W
</td>
<td style="text-align:right;">
30.61337
</td>
<td style="text-align:right;">
-96.32098
</td>
</tr>
<tr>
<td style="text-align:left;">
BRYAN CERAMICS PLANT
</td>
<td style="text-align:left;">
TX0000004804100027
</td>
<td style="text-align:left;">
1500 INDEPENDENCE AVE
</td>
<td style="text-align:right;">
30.63760
</td>
<td style="text-align:right;">
-96.36235
</td>
</tr>
<tr>
<td style="text-align:left;">
BRYAN CLEANERS &amp; LAUNDRY
</td>
<td style="text-align:left;">
06000000480416E012
</td>
<td style="text-align:left;">
1803 HOLLEMAN DRIVE
</td>
<td style="text-align:right;">
30.61225
</td>
<td style="text-align:right;">
-96.31750
</td>
</tr>
</tbody>
</table>
</div>
<p>Some example arguments are listed below:</p>
<pre><code>p_fn  string  Facility Name Filter.
              One or more case-insesitive facility names.
              Provide multiple values as comma-delimited list
              ex:
              p_fn = &quot;Aggie Cleaners, City of Bryan, TEXAS A&amp;M UNIVERSITY COLLEGE STATION CAMPUS&quot;
              
p_sa  string  Facility Street Address
              ex:
              p_sa = &quot;WELLBORN ROAD &amp; UNIVERSITY DR&quot;
              
p_ct  string  Facility City
              Provide a single case-insensitive city name
              ex:
              p_ct = &quot;College Station&quot;
              
p_co  string  Facility County
              Provide a single county name, in combination with a state value
              provided through p_st
              ex:
              p_co = &quot;Brazos&quot;, p_st = &quot;Texas&quot;
              
p_fips  string  FIPS Code
                Single 5-character Federal Information Processing Standards (FIPS) 
                state+county value
                
p_st  string  Facility State or State Equivalent Filter
              Provide one or more USPS postal abbreviations
              ex:
              p_st = &quot;TX, NC&quot;
              
p_zip string  Facility 5-Digit Zip Code
              Provide one or more 5-digit postal zip codes
              ex:
              p_zip = &quot;77843, 77845&quot;
              
xmin  string  Minimum longitude value in decimal degrees

ymin  string  Minimum latitude value in decimal degrees

xmax  string  Maximum longitude value in decimal degrees

ymax  string  Maximum latitude value in decimal degrees</code></pre>
<p>Step 3 - Download the emission inventory report for a permitted facility:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1">df &lt;-<span class="st"> </span><span class="kw">echoGetCAAPR</span>(<span class="dt">p_id =</span> <span class="st">'110000350174'</span>)</a></code></pre></div>
<div style="border: 1px solid #ddd; padding: 5px; overflow-y: scroll; height:200px; overflow-x: scroll; width:500px; ">
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
Name
</th>
<th style="text-align:left;">
SourceID
</th>
<th style="text-align:left;">
Street
</th>
<th style="text-align:left;">
City
</th>
<th style="text-align:left;">
State
</th>
<th style="text-align:left;">
Zip
</th>
<th style="text-align:left;">
County
</th>
<th style="text-align:left;">
Region
</th>
<th style="text-align:right;">
Latitude
</th>
<th style="text-align:right;">
Longitude
</th>
<th style="text-align:left;">
Pollutant
</th>
<th style="text-align:left;">
UnitsOfMeasure
</th>
<th style="text-align:left;">
Program
</th>
<th style="text-align:right;">
Year
</th>
<th style="text-align:right;">
Discharge
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
CP&amp;L - SUTTON PLANT
</td>
<td style="text-align:left;">
110000350174
</td>
<td style="text-align:left;">
801 SUTTON STEAM PLANT ROAD
</td>
<td style="text-align:left;">
WILMINGTON
</td>
<td style="text-align:left;">
NC
</td>
<td style="text-align:left;">
28401
</td>
<td style="text-align:left;">
NEW HANOVER
</td>
<td style="text-align:left;">
04
</td>
<td style="text-align:right;">
34.28332
</td>
<td style="text-align:right;">
-77.98523
</td>
<td style="text-align:left;">
1,2-Dichloroethane
</td>
<td style="text-align:left;">
Pounds
</td>
<td style="text-align:left;">
NEI
</td>
<td style="text-align:right;">
2008
</td>
<td style="text-align:right;">
47.95
</td>
</tr>
<tr>
<td style="text-align:left;">
CP&amp;L - SUTTON PLANT
</td>
<td style="text-align:left;">
110000350174
</td>
<td style="text-align:left;">
801 SUTTON STEAM PLANT ROAD
</td>
<td style="text-align:left;">
WILMINGTON
</td>
<td style="text-align:left;">
NC
</td>
<td style="text-align:left;">
28401
</td>
<td style="text-align:left;">
NEW HANOVER
</td>
<td style="text-align:left;">
04
</td>
<td style="text-align:right;">
34.28332
</td>
<td style="text-align:right;">
-77.98523
</td>
<td style="text-align:left;">
Acetophenone
</td>
<td style="text-align:left;">
Pounds
</td>
<td style="text-align:left;">
NEI
</td>
<td style="text-align:right;">
2008
</td>
<td style="text-align:right;">
17.98
</td>
</tr>
<tr>
<td style="text-align:left;">
CP&amp;L - SUTTON PLANT
</td>
<td style="text-align:left;">
110000350174
</td>
<td style="text-align:left;">
801 SUTTON STEAM PLANT ROAD
</td>
<td style="text-align:left;">
WILMINGTON
</td>
<td style="text-align:left;">
NC
</td>
<td style="text-align:left;">
28401
</td>
<td style="text-align:left;">
NEW HANOVER
</td>
<td style="text-align:left;">
04
</td>
<td style="text-align:right;">
34.28332
</td>
<td style="text-align:right;">
-77.98523
</td>
<td style="text-align:left;">
Anthracene
</td>
<td style="text-align:left;">
Pounds
</td>
<td style="text-align:left;">
NEI
</td>
<td style="text-align:right;">
2008
</td>
<td style="text-align:right;">
0.25
</td>
</tr>
<tr>
<td style="text-align:left;">
CP&amp;L - SUTTON PLANT
</td>
<td style="text-align:left;">
110000350174
</td>
<td style="text-align:left;">
801 SUTTON STEAM PLANT ROAD
</td>
<td style="text-align:left;">
WILMINGTON
</td>
<td style="text-align:left;">
NC
</td>
<td style="text-align:left;">
28401
</td>
<td style="text-align:left;">
NEW HANOVER
</td>
<td style="text-align:left;">
04
</td>
<td style="text-align:right;">
34.28332
</td>
<td style="text-align:right;">
-77.98523
</td>
<td style="text-align:left;">
Dimethyl sulfate
</td>
<td style="text-align:left;">
Pounds
</td>
<td style="text-align:left;">
NEI
</td>
<td style="text-align:right;">
2008
</td>
<td style="text-align:right;">
63.19
</td>
</tr>
<tr>
<td style="text-align:left;">
CP&amp;L - SUTTON PLANT
</td>
<td style="text-align:left;">
110000350174
</td>
<td style="text-align:left;">
801 SUTTON STEAM PLANT ROAD
</td>
<td style="text-align:left;">
WILMINGTON
</td>
<td style="text-align:left;">
NC
</td>
<td style="text-align:left;">
28401
</td>
<td style="text-align:left;">
NEW HANOVER
</td>
<td style="text-align:left;">
04
</td>
<td style="text-align:right;">
34.28332
</td>
<td style="text-align:right;">
-77.98523
</td>
<td style="text-align:left;">
Hexane
</td>
<td style="text-align:left;">
Pounds
</td>
<td style="text-align:left;">
NEI
</td>
<td style="text-align:right;">
2008
</td>
<td style="text-align:right;">
80.31
</td>
</tr>
<tr>
<td style="text-align:left;">
CP&amp;L - SUTTON PLANT
</td>
<td style="text-align:left;">
110000350174
</td>
<td style="text-align:left;">
801 SUTTON STEAM PLANT ROAD
</td>
<td style="text-align:left;">
WILMINGTON
</td>
<td style="text-align:left;">
NC
</td>
<td style="text-align:left;">
28401
</td>
<td style="text-align:left;">
NEW HANOVER
</td>
<td style="text-align:left;">
04
</td>
<td style="text-align:right;">
34.28332
</td>
<td style="text-align:right;">
-77.98523
</td>
<td style="text-align:left;">
Manganese
</td>
<td style="text-align:left;">
Pounds
</td>
<td style="text-align:left;">
NEI
</td>
<td style="text-align:right;">
2008
</td>
<td style="text-align:right;">
290.51
</td>
</tr>
</tbody>
</table>
</div>
<p>There are only two valid arguments for <code>echoGetCAAPR</code>.</p>
<pre><code>p_id  string  EPA Facility Registry Service's REGISTRY_ID.

p_units string  Units of measurement. Defaults is 'lbs'.
                Enter &quot;TPWE&quot; for toxic weighted pounds equivalents.</code></pre>
</div>
<div id="water-facility-and-discharge-searches" class="section level3">
<h3>Water facility and discharge searches</h3>
<p>Find facilites with NPDES permits to discharge wastewater:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1">df &lt;-<span class="st"> </span><span class="kw">echoWaterGetFacilityInfo</span>(<span class="dt">xmin =</span> <span class="st">'-96.407563'</span>, <span class="dt">ymin =</span> <span class="st">'30.554395'</span>, </a>
<a class="sourceLine" id="cb6-2" data-line-number="2">                               <span class="dt">xmax =</span> <span class="st">'-96.25947'</span>,  <span class="dt">ymax =</span> <span class="st">'30.751984'</span>, </a>
<a class="sourceLine" id="cb6-3" data-line-number="3">                               <span class="dt">output =</span> <span class="st">'df'</span>)</a></code></pre></div>
<div style="border: 1px solid #ddd; padding: 5px; overflow-y: scroll; height:200px; overflow-x: scroll; width:500px; ">
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
CWPName
</th>
<th style="text-align:left;">
SourceID
</th>
<th style="text-align:left;">
CWPStreet
</th>
<th style="text-align:left;">
CWPCity
</th>
<th style="text-align:left;">
CWPState
</th>
<th style="text-align:left;">
CWPStateDistrict
</th>
<th style="text-align:left;">
CWPZip
</th>
<th style="text-align:left;">
MasterExternalPermitNmbr
</th>
<th style="text-align:left;">
RegistryID
</th>
<th style="text-align:left;">
CWPCounty
</th>
<th style="text-align:left;">
CWPEPARegion
</th>
<th style="text-align:left;">
FacDerivedHuc
</th>
<th style="text-align:right;">
FacLat
</th>
<th style="text-align:right;">
FacLong
</th>
<th style="text-align:right;">
CWPTotalDesignFlowNmbr
</th>
<th style="text-align:right;">
CWPActualAverageFlowNmbr
</th>
<th style="text-align:left;">
ReceivingMs4Name
</th>
<th style="text-align:left;">
AssociatedPollutant
</th>
<th style="text-align:left;">
MsgpPermitType
</th>
<th style="text-align:left;">
CWPPermitStatusDesc
</th>
<th style="text-align:left;">
CWPPermitTypeDesc
</th>
<th style="text-align:left;">
CWPIssueDate
</th>
<th style="text-align:left;">
CWPEffectiveDate
</th>
<th style="text-align:left;">
CWPExpirationDate
</th>
<th style="text-align:left;">
CWPSNCStatusDate
</th>
<th style="text-align:left;">
CWPStateWaterBodyCode
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
ACE TOWNHOME
</td>
<td style="text-align:left;">
TXR15667I
</td>
<td style="text-align:left;">
2136 CHESTNUT OAK CIR
</td>
<td style="text-align:left;">
COLLEGE STATION
</td>
<td style="text-align:left;">
TX
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
77845-4168
</td>
<td style="text-align:left;">
TXR150000
</td>
<td style="text-align:left;">
110070364352
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
06
</td>
<td style="text-align:left;">
12070103
</td>
<td style="text-align:right;">
30.61411
</td>
<td style="text-align:right;">
-96.28490
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
Effective
</td>
<td style="text-align:left;">
General Permit Covered Facility
</td>
<td style="text-align:left;">
2018-06-01
</td>
<td style="text-align:left;">
2018-06-01
</td>
<td style="text-align:left;">
2023-03-05
</td>
<td style="text-align:left;">
2018-09-30
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
AGGIE ACRES WWTP
</td>
<td style="text-align:left;">
TX0132187
</td>
<td style="text-align:left;">
800 FT SE OF N DOWLING RD APPROX 600 FT SW OF WALN
</td>
<td style="text-align:left;">
COLLEGE STATION
</td>
<td style="text-align:left;">
TX
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
77845
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
110064633829
</td>
<td style="text-align:left;">
Brazos
</td>
<td style="text-align:left;">
06
</td>
<td style="text-align:left;">
</td>
<td style="text-align:right;">
30.55565
</td>
<td style="text-align:right;">
-96.29110
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
Not Needed
</td>
<td style="text-align:left;">
NPDES Individual Permit
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
2018-09-30
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
AGRIVEST SWINE FEEDLOT
</td>
<td style="text-align:left;">
TX0121240
</td>
<td style="text-align:left;">
SWISHER COUNTY
</td>
<td style="text-align:left;">
BRYAN
</td>
<td style="text-align:left;">
TX
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
00000
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
110039193271
</td>
<td style="text-align:left;">
Swisher
</td>
<td style="text-align:left;">
06
</td>
<td style="text-align:left;">
</td>
<td style="text-align:right;">
30.66658
</td>
<td style="text-align:right;">
-96.36552
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
Terminated
</td>
<td style="text-align:left;">
NPDES Individual Permit
</td>
<td style="text-align:left;">
2000-01-14
</td>
<td style="text-align:left;">
2000-01-14
</td>
<td style="text-align:left;">
2004-07-27
</td>
<td style="text-align:left;">
2018-09-30
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
ALENCO WINDOWS
</td>
<td style="text-align:left;">
TXR05U808
</td>
<td style="text-align:left;">
615 W CARSON ST
</td>
<td style="text-align:left;">
BRYAN
</td>
<td style="text-align:left;">
TX
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
77801-1102
</td>
<td style="text-align:left;">
TXR050000
</td>
<td style="text-align:left;">
110000464284
</td>
<td style="text-align:left;">
Brazos
</td>
<td style="text-align:left;">
06
</td>
<td style="text-align:left;">
12070103
</td>
<td style="text-align:right;">
30.64457
</td>
<td style="text-align:right;">
-96.37270
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
Effective
</td>
<td style="text-align:left;">
General Permit Covered Facility
</td>
<td style="text-align:left;">
2016-10-28
</td>
<td style="text-align:left;">
2016-11-01
</td>
<td style="text-align:left;">
2021-08-13
</td>
<td style="text-align:left;">
2018-09-30
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
ANDREWS ORTHODONTIST AND RETAIL BUILDING
</td>
<td style="text-align:left;">
TXR15193R
</td>
<td style="text-align:left;">
1098 ARRINGTON RD
</td>
<td style="text-align:left;">
COLLEGE STATION
</td>
<td style="text-align:left;">
TX
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
77845
</td>
<td style="text-align:left;">
TXR150000
</td>
<td style="text-align:left;">
110070368658
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
06
</td>
<td style="text-align:left;">
12070103
</td>
<td style="text-align:right;">
30.55800
</td>
<td style="text-align:right;">
-96.26566
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
Effective
</td>
<td style="text-align:left;">
General Permit Covered Facility
</td>
<td style="text-align:left;">
2018-08-27
</td>
<td style="text-align:left;">
2018-09-01
</td>
<td style="text-align:left;">
2023-03-05
</td>
<td style="text-align:left;">
2018-09-30
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
ASTIN AVIATION
</td>
<td style="text-align:left;">
TXR05CE76
</td>
<td style="text-align:left;">
1770 GEORGE BUSH DR W
</td>
<td style="text-align:left;">
COLLEGE STATION
</td>
<td style="text-align:left;">
TX
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
77845-4761
</td>
<td style="text-align:left;">
TXR050000
</td>
<td style="text-align:left;">
110070360445
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
06
</td>
<td style="text-align:left;">
12070101
</td>
<td style="text-align:right;">
30.59288
</td>
<td style="text-align:right;">
-96.35277
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
Effective
</td>
<td style="text-align:left;">
General Permit Covered Facility
</td>
<td style="text-align:left;">
2017-07-10
</td>
<td style="text-align:left;">
2017-08-01
</td>
<td style="text-align:left;">
2021-08-13
</td>
<td style="text-align:left;">
2018-09-30
</td>
<td style="text-align:left;">
</td>
</tr>
</tbody>
</table>
</div>
<p>Again, there are a ton of possible arguments to query ECHO with. All arguments are described here: <a href="https://echo.epa.gov/tools/web-services/facility-search-water#!/Facility_Information/get_cwa_rest_services_get_facility_info" class="uri">https://echo.epa.gov/tools/web-services/facility-search-water#!/Facility_Information/get_cwa_rest_services_get_facility_info</a></p>
<p>Commonly used arguments are provided below:</p>
<pre><code>p_fn  string  Facility Name Filter.
              One or more case-insesitive facility names.
              Provide multiple values as comma-delimited list
              ex:
              p_fn = &quot;Aggie Cleaners, City of Bryan, TEXAS A&amp;M UNIVERSITY COLLEGE STATION CAMPUS&quot;
              
p_sa  string  Facility Street Address
              ex:
              p_sa = &quot;WELLBORN ROAD &amp; UNIVERSITY DR&quot;
              
p_ct  string  Facility City
              Provide a single case-insensitive city name
              ex:
              p_ct = &quot;College Station&quot;
              
p_co  string  Facility County
              Provide a single county name, in combination with a state value
              provided through p_st
              ex:
              p_co = &quot;Brazos&quot;, p_st = &quot;Texas&quot;
              
p_fips  string  FIPS Code
                Single 5-character Federal Information Processing Standards (FIPS) 
                state+county value
                
p_st  string  Facility State or State Equivalent Filter
              Provide one or more USPS postal abbreviations
              ex:
              p_st = &quot;TX, NC&quot;
              
p_zip string  Facility 5-Digit Zip Code
              Provide one or more 5-digit postal zip codes
              ex:
              p_zip = &quot;77843, 77845&quot;
              
xmin  string  Minimum longitude value in decimal degrees

ymin  string  Minimum latitude value in decimal degrees

xmax  string  Maximum longitude value in decimal degrees

ymax  string  Maximum latitude value in decimal degrees

p_huc string  2-,4,6-,or 8-digit watershed code.
              May contain comma-seperated values
              </code></pre>
<p>Download discharge monitoring reports from ECHO from specified facilities:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1">df &lt;-<span class="st"> </span><span class="kw">echoGetEffluent</span>(<span class="dt">p_id =</span> <span class="st">'tx0119407'</span>, <span class="dt">parameter_code =</span> <span class="st">'50050'</span>)</a></code></pre></div>
<div style="border: 1px solid #ddd; padding: 5px; overflow-y: scroll; height:200px; overflow-x: scroll; width:500px; ">
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
activity_id
</th>
<th style="text-align:left;">
npdes_id
</th>
<th style="text-align:left;">
version_nmbr
</th>
<th style="text-align:left;">
perm_feature_id
</th>
<th style="text-align:left;">
perm_feature_nmbr
</th>
<th style="text-align:left;">
perm_feature_type_code
</th>
<th style="text-align:left;">
perm_feature_type_desc
</th>
<th style="text-align:left;">
limit_set_id
</th>
<th style="text-align:left;">
limit_set_schedule_id
</th>
<th style="text-align:left;">
limit_id
</th>
<th style="text-align:left;">
limit_type_code
</th>
<th style="text-align:left;">
limit_begin_date
</th>
<th style="text-align:left;">
limit_end_date
</th>
<th style="text-align:left;">
nmbr_of_submission
</th>
<th style="text-align:left;">
parameter_code
</th>
<th style="text-align:left;">
parameter_desc
</th>
<th style="text-align:left;">
monitoring_location_code
</th>
<th style="text-align:left;">
monitoring_location_desc
</th>
<th style="text-align:left;">
stay_type_code
</th>
<th style="text-align:left;">
stay_type_desc
</th>
<th style="text-align:left;">
limit_value_id
</th>
<th style="text-align:left;">
limit_value_type_code
</th>
<th style="text-align:left;">
limit_value_type_desc
</th>
<th style="text-align:left;">
limit_value_nmbr
</th>
<th style="text-align:left;">
limit_unit_code
</th>
<th style="text-align:left;">
limit_unit_desc
</th>
<th style="text-align:left;">
standard_unit_code
</th>
<th style="text-align:left;">
standard_unit_desc
</th>
<th style="text-align:left;">
limit_value_standard_units
</th>
<th style="text-align:left;">
statistical_base_code
</th>
<th style="text-align:left;">
statistical_base_short_desc
</th>
<th style="text-align:left;">
statistical_base_type_code
</th>
<th style="text-align:left;">
statistical_base_type_desc
</th>
<th style="text-align:left;">
limit_value_qualifier_code
</th>
<th style="text-align:left;">
stay_value_nmbr
</th>
<th style="text-align:left;">
dmr_event_id
</th>
<th style="text-align:left;">
monitoring_period_end_date
</th>
<th style="text-align:left;">
dmr_form_value_id
</th>
<th style="text-align:left;">
value_type_code
</th>
<th style="text-align:left;">
value_type_desc
</th>
<th style="text-align:left;">
dmr_value_id
</th>
<th style="text-align:left;">
dmr_value_nmbr
</th>
<th style="text-align:left;">
dmr_unit_code
</th>
<th style="text-align:left;">
dmr_unit_desc
</th>
<th style="text-align:left;">
dmr_value_standard_units
</th>
<th style="text-align:left;">
dmr_value_qualifier_code
</th>
<th style="text-align:left;">
value_received_date
</th>
<th style="text-align:left;">
days_late
</th>
<th style="text-align:left;">
nodi_code
</th>
<th style="text-align:left;">
nodi_desc
</th>
<th style="text-align:left;">
exceedence_pct
</th>
<th style="text-align:left;">
npdes_violation_id
</th>
<th style="text-align:left;">
violation_code
</th>
<th style="text-align:left;">
violation_desc
</th>
<th style="text-align:left;">
rnc_detection_code
</th>
<th style="text-align:left;">
rnc_detection_desc
</th>
<th style="text-align:left;">
rnc_detection_date
</th>
<th style="text-align:left;">
rnc_resolution_code
</th>
<th style="text-align:left;">
rnc_resolution_desc
</th>
<th style="text-align:left;">
rnc_resolution_date
</th>
<th style="text-align:left;">
violation_severity
</th>
</tr>
</thead>
<tbody>
<tr>
</tr>
</tbody>
</table>
</div>
<p>This function only retrieves from a single facility per call. The following arguments are available from ECHO:</p>
<pre><code>p_id  string  EPA Facility Registry Service's REGISTRY_ID.

outfall string  Three-character code identifying the point of discharge.

parameter_code  string  Five-digit numeric code identifying the parameter.

start_date  string  Start date of interest. Must be entered as &quot;mm/dd/yyyy&quot;

end_date  string  End date of interest. Must be entered as &quot;mm/dd/yyyy&quot;</code></pre>
<p>Parameters codes can be searched using <code>echoWaterGetParams</code>.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1"><span class="kw">echoWaterGetParams</span>(<span class="dt">term =</span> <span class="st">&quot;Oxygen, dissolved&quot;</span>)</a>
<a class="sourceLine" id="cb10-2" data-line-number="2"><span class="co">#&gt; # A tibble: 5 x 2</span></a>
<a class="sourceLine" id="cb10-3" data-line-number="3"><span class="co">#&gt;   ValueCode ValueDescription                     </span></a>
<a class="sourceLine" id="cb10-4" data-line-number="4"><span class="co">#&gt;   &lt;chr&gt;     &lt;chr&gt;                                </span></a>
<a class="sourceLine" id="cb10-5" data-line-number="5"><span class="co">#&gt; 1 00300     Oxygen, dissolved [DO]               </span></a>
<a class="sourceLine" id="cb10-6" data-line-number="6"><span class="co">#&gt; 2 51646     Oxygen, dissolved [DO] maximum       </span></a>
<a class="sourceLine" id="cb10-7" data-line-number="7"><span class="co">#&gt; 3 51645     Oxygen, dissolved [DO] minimum       </span></a>
<a class="sourceLine" id="cb10-8" data-line-number="8"><span class="co">#&gt; 4 00301     Oxygen, dissolved percent saturation </span></a>
<a class="sourceLine" id="cb10-9" data-line-number="9"><span class="co">#&gt; 5 00399     Oxygen, dissolved, % of time violated</span></a></code></pre></div>
<p>Available arguments include:</p>
<pre><code>term string partial or complete search phrase or word

code  string  partial or complete code value</code></pre>
<p>You can only enter either term or code arguments.</p>
<p>Multiple DMRs can be downloaded using a helper function: <code>downloadDMRs</code>:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1">df &lt;-<span class="st"> </span>tibble<span class="op">::</span><span class="kw">tibble</span>(<span class="dt">permit =</span> <span class="kw">c</span>(<span class="st">'TX0119407'</span>, <span class="st">'TX040237'</span>))</a>
<a class="sourceLine" id="cb12-2" data-line-number="2">df &lt;-<span class="st"> </span><span class="kw">downloadDMRs</span>(df, <span class="dt">idColumn =</span> permit)</a>
<a class="sourceLine" id="cb12-3" data-line-number="3">df &lt;-<span class="st"> </span>tidyr<span class="op">::</span><span class="kw">unnest</span>(df)</a>
<a class="sourceLine" id="cb12-4" data-line-number="4">tibble<span class="op">::</span><span class="kw">glimpse</span>(df)</a>
<a class="sourceLine" id="cb12-5" data-line-number="5"><span class="co">#&gt; Observations: 880</span></a>
<a class="sourceLine" id="cb12-6" data-line-number="6"><span class="co">#&gt; Variables: 62</span></a>
<a class="sourceLine" id="cb12-7" data-line-number="7"><span class="co">#&gt; $ permit                      &lt;chr&gt; &quot;TX0119407&quot;, &quot;TX0119407&quot;, &quot;TX01194...</span></a>
<a class="sourceLine" id="cb12-8" data-line-number="8"><span class="co">#&gt; $ activity_id                 &lt;chr&gt; &quot;3600178396&quot;, &quot;3600178396&quot;, &quot;36001...</span></a>
<a class="sourceLine" id="cb12-9" data-line-number="9"><span class="co">#&gt; $ npdes_id                    &lt;chr&gt; &quot;TX0119407&quot;, &quot;TX0119407&quot;, &quot;TX01194...</span></a>
<a class="sourceLine" id="cb12-10" data-line-number="10"><span class="co">#&gt; $ version_nmbr                &lt;int&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0...</span></a>
<a class="sourceLine" id="cb12-11" data-line-number="11"><span class="co">#&gt; $ perm_feature_id             &lt;chr&gt; &quot;3600049681&quot;, &quot;3600049681&quot;, &quot;36000...</span></a>
<a class="sourceLine" id="cb12-12" data-line-number="12"><span class="co">#&gt; $ perm_feature_nmbr           &lt;chr&gt; &quot;001&quot;, &quot;001&quot;, &quot;001&quot;, &quot;001&quot;, &quot;001&quot;,...</span></a>
<a class="sourceLine" id="cb12-13" data-line-number="13"><span class="co">#&gt; $ perm_feature_type_code      &lt;chr&gt; &quot;EXO&quot;, &quot;EXO&quot;, &quot;EXO&quot;, &quot;EXO&quot;, &quot;EXO&quot;,...</span></a>
<a class="sourceLine" id="cb12-14" data-line-number="14"><span class="co">#&gt; $ perm_feature_type_desc      &lt;chr&gt; &quot;External Outfall&quot;, &quot;External Outf...</span></a>
<a class="sourceLine" id="cb12-15" data-line-number="15"><span class="co">#&gt; $ limit_set_id                &lt;dbl&gt; 3600061722, 3600061722, 3600061722...</span></a>
<a class="sourceLine" id="cb12-16" data-line-number="16"><span class="co">#&gt; $ limit_set_schedule_id       &lt;dbl&gt; 3600073706, 3600073706, 3600073706...</span></a>
<a class="sourceLine" id="cb12-17" data-line-number="17"><span class="co">#&gt; $ limit_id                    &lt;dbl&gt; 3600437315, 3600437315, 3600437315...</span></a>
<a class="sourceLine" id="cb12-18" data-line-number="18"><span class="co">#&gt; $ limit_type_code             &lt;chr&gt; &quot;ENF&quot;, &quot;ENF&quot;, &quot;ENF&quot;, &quot;ENF&quot;, &quot;ENF&quot;,...</span></a>
<a class="sourceLine" id="cb12-19" data-line-number="19"><span class="co">#&gt; $ limit_begin_date            &lt;date&gt; 2015-08-01, 2015-08-01, 2015-08-0...</span></a>
<a class="sourceLine" id="cb12-20" data-line-number="20"><span class="co">#&gt; $ limit_end_date              &lt;date&gt; 2020-03-01, 2020-03-01, 2020-03-0...</span></a>
<a class="sourceLine" id="cb12-21" data-line-number="21"><span class="co">#&gt; $ nmbr_of_submission          &lt;int&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1...</span></a>
<a class="sourceLine" id="cb12-22" data-line-number="22"><span class="co">#&gt; $ parameter_code              &lt;chr&gt; &quot;00300&quot;, &quot;00300&quot;, &quot;00300&quot;, &quot;00300&quot;...</span></a>
<a class="sourceLine" id="cb12-23" data-line-number="23"><span class="co">#&gt; $ parameter_desc              &lt;chr&gt; &quot;Oxygen, dissolved [DO]&quot;, &quot;Oxygen,...</span></a>
<a class="sourceLine" id="cb12-24" data-line-number="24"><span class="co">#&gt; $ monitoring_location_code    &lt;chr&gt; &quot;1&quot;, &quot;1&quot;, &quot;1&quot;, &quot;1&quot;, &quot;1&quot;, &quot;1&quot;, &quot;1&quot;,...</span></a>
<a class="sourceLine" id="cb12-25" data-line-number="25"><span class="co">#&gt; $ monitoring_location_desc    &lt;chr&gt; &quot;Effluent Gross&quot;, &quot;Effluent Gross&quot;...</span></a>
<a class="sourceLine" id="cb12-26" data-line-number="26"><span class="co">#&gt; $ stay_type_code              &lt;chr&gt; &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;...</span></a>
<a class="sourceLine" id="cb12-27" data-line-number="27"><span class="co">#&gt; $ stay_type_desc              &lt;chr&gt; &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;...</span></a>
<a class="sourceLine" id="cb12-28" data-line-number="28"><span class="co">#&gt; $ limit_value_id              &lt;chr&gt; &quot;3600678121&quot;, &quot;3600678121&quot;, &quot;36006...</span></a>
<a class="sourceLine" id="cb12-29" data-line-number="29"><span class="co">#&gt; $ limit_value_type_code       &lt;chr&gt; &quot;C1&quot;, &quot;C1&quot;, &quot;C1&quot;, &quot;C1&quot;, &quot;C1&quot;, &quot;C1&quot;...</span></a>
<a class="sourceLine" id="cb12-30" data-line-number="30"><span class="co">#&gt; $ limit_value_type_desc       &lt;chr&gt; &quot;Concentration1&quot;, &quot;Concentration1&quot;...</span></a>
<a class="sourceLine" id="cb12-31" data-line-number="31"><span class="co">#&gt; $ limit_value_nmbr            &lt;dbl&gt; 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4...</span></a>
<a class="sourceLine" id="cb12-32" data-line-number="32"><span class="co">#&gt; $ limit_unit_code             &lt;chr&gt; &quot;19&quot;, &quot;19&quot;, &quot;19&quot;, &quot;19&quot;, &quot;19&quot;, &quot;19&quot;...</span></a>
<a class="sourceLine" id="cb12-33" data-line-number="33"><span class="co">#&gt; $ limit_unit_desc             &lt;chr&gt; &quot;mg/L&quot;, &quot;mg/L&quot;, &quot;mg/L&quot;, &quot;mg/L&quot;, &quot;m...</span></a>
<a class="sourceLine" id="cb12-34" data-line-number="34"><span class="co">#&gt; $ standard_unit_code          &lt;chr&gt; &quot;19&quot;, &quot;19&quot;, &quot;19&quot;, &quot;19&quot;, &quot;19&quot;, &quot;19&quot;...</span></a>
<a class="sourceLine" id="cb12-35" data-line-number="35"><span class="co">#&gt; $ standard_unit_desc          &lt;chr&gt; &quot;mg/L&quot;, &quot;mg/L&quot;, &quot;mg/L&quot;, &quot;mg/L&quot;, &quot;m...</span></a>
<a class="sourceLine" id="cb12-36" data-line-number="36"><span class="co">#&gt; $ limit_value_standard_units  &lt;dbl&gt; 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4...</span></a>
<a class="sourceLine" id="cb12-37" data-line-number="37"><span class="co">#&gt; $ statistical_base_code       &lt;chr&gt; &quot;MO&quot;, &quot;MO&quot;, &quot;MO&quot;, &quot;MO&quot;, &quot;MO&quot;, &quot;MO&quot;...</span></a>
<a class="sourceLine" id="cb12-38" data-line-number="38"><span class="co">#&gt; $ statistical_base_short_desc &lt;chr&gt; &quot;MO MIN&quot;, &quot;MO MIN&quot;, &quot;MO MIN&quot;, &quot;MO ...</span></a>
<a class="sourceLine" id="cb12-39" data-line-number="39"><span class="co">#&gt; $ statistical_base_type_code  &lt;chr&gt; &quot;MIN&quot;, &quot;MIN&quot;, &quot;MIN&quot;, &quot;MIN&quot;, &quot;MIN&quot;,...</span></a>
<a class="sourceLine" id="cb12-40" data-line-number="40"><span class="co">#&gt; $ statistical_base_type_desc  &lt;chr&gt; &quot;Minimum&quot;, &quot;Minimum&quot;, &quot;Minimum&quot;, &quot;...</span></a>
<a class="sourceLine" id="cb12-41" data-line-number="41"><span class="co">#&gt; $ limit_value_qualifier_code  &lt;chr&gt; &quot;&gt;=&quot;, &quot;&gt;=&quot;, &quot;&gt;=&quot;, &quot;&gt;=&quot;, &quot;&gt;=&quot;, &quot;&gt;=&quot;...</span></a>
<a class="sourceLine" id="cb12-42" data-line-number="42"><span class="co">#&gt; $ stay_value_nmbr             &lt;chr&gt; &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;...</span></a>
<a class="sourceLine" id="cb12-43" data-line-number="43"><span class="co">#&gt; $ dmr_event_id                &lt;chr&gt; &quot;3403423185&quot;, &quot;3403423200&quot;, &quot;34034...</span></a>
<a class="sourceLine" id="cb12-44" data-line-number="44"><span class="co">#&gt; $ monitoring_period_end_date  &lt;date&gt; 2015-10-31, 2015-11-30, 2015-12-3...</span></a>
<a class="sourceLine" id="cb12-45" data-line-number="45"><span class="co">#&gt; $ dmr_form_value_id           &lt;chr&gt; &quot;3442281413&quot;, &quot;3442281617&quot;, &quot;34422...</span></a>
<a class="sourceLine" id="cb12-46" data-line-number="46"><span class="co">#&gt; $ value_type_code             &lt;chr&gt; &quot;C1&quot;, &quot;C1&quot;, &quot;C1&quot;, &quot;C1&quot;, &quot;C1&quot;, &quot;C1&quot;...</span></a>
<a class="sourceLine" id="cb12-47" data-line-number="47"><span class="co">#&gt; $ value_type_desc             &lt;chr&gt; &quot;Concentration1&quot;, &quot;Concentration1&quot;...</span></a>
<a class="sourceLine" id="cb12-48" data-line-number="48"><span class="co">#&gt; $ dmr_value_id                &lt;chr&gt; &quot;3614856990&quot;, &quot;3616166174&quot;, &quot;36168...</span></a>
<a class="sourceLine" id="cb12-49" data-line-number="49"><span class="co">#&gt; $ dmr_value_nmbr              &lt;dbl&gt; 5.21, 7.90, 6.50, 7.80, 5.36, 4.60...</span></a>
<a class="sourceLine" id="cb12-50" data-line-number="50"><span class="co">#&gt; $ dmr_unit_code               &lt;chr&gt; &quot;19&quot;, &quot;19&quot;, &quot;19&quot;, &quot;19&quot;, &quot;19&quot;, &quot;19&quot;...</span></a>
<a class="sourceLine" id="cb12-51" data-line-number="51"><span class="co">#&gt; $ dmr_unit_desc               &lt;chr&gt; &quot;mg/L&quot;, &quot;mg/L&quot;, &quot;mg/L&quot;, &quot;mg/L&quot;, &quot;m...</span></a>
<a class="sourceLine" id="cb12-52" data-line-number="52"><span class="co">#&gt; $ dmr_value_standard_units    &lt;dbl&gt; 5.21, 7.90, 6.50, 7.80, 5.36, 4.60...</span></a>
<a class="sourceLine" id="cb12-53" data-line-number="53"><span class="co">#&gt; $ dmr_value_qualifier_code    &lt;chr&gt; &quot;=&quot;, &quot;=&quot;, &quot;=&quot;, &quot;=&quot;, &quot;=&quot;, &quot;=&quot;, &quot;=&quot;,...</span></a>
<a class="sourceLine" id="cb12-54" data-line-number="54"><span class="co">#&gt; $ value_received_date         &lt;date&gt; 2015-11-20, 2015-12-29, 2016-01-1...</span></a>
<a class="sourceLine" id="cb12-55" data-line-number="55"><span class="co">#&gt; $ days_late                   &lt;int&gt; NA, 9, NA, NA, 1, NA, NA, NA, NA, ...</span></a>
<a class="sourceLine" id="cb12-56" data-line-number="56"><span class="co">#&gt; $ nodi_code                   &lt;chr&gt; &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;...</span></a>
<a class="sourceLine" id="cb12-57" data-line-number="57"><span class="co">#&gt; $ nodi_desc                   &lt;chr&gt; &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;...</span></a>
<a class="sourceLine" id="cb12-58" data-line-number="58"><span class="co">#&gt; $ exceedence_pct              &lt;int&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA...</span></a>
<a class="sourceLine" id="cb12-59" data-line-number="59"><span class="co">#&gt; $ npdes_violation_id          &lt;chr&gt; &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;...</span></a>
<a class="sourceLine" id="cb12-60" data-line-number="60"><span class="co">#&gt; $ violation_code              &lt;chr&gt; &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;...</span></a>
<a class="sourceLine" id="cb12-61" data-line-number="61"><span class="co">#&gt; $ violation_desc              &lt;chr&gt; &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;...</span></a>
<a class="sourceLine" id="cb12-62" data-line-number="62"><span class="co">#&gt; $ rnc_detection_code          &lt;chr&gt; &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;...</span></a>
<a class="sourceLine" id="cb12-63" data-line-number="63"><span class="co">#&gt; $ rnc_detection_desc          &lt;chr&gt; &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;...</span></a>
<a class="sourceLine" id="cb12-64" data-line-number="64"><span class="co">#&gt; $ rnc_detection_date          &lt;date&gt; NA, NA, NA, NA, NA, NA, NA, NA, N...</span></a>
<a class="sourceLine" id="cb12-65" data-line-number="65"><span class="co">#&gt; $ rnc_resolution_code         &lt;int&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA...</span></a>
<a class="sourceLine" id="cb12-66" data-line-number="66"><span class="co">#&gt; $ rnc_resolution_desc         &lt;chr&gt; &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;...</span></a>
<a class="sourceLine" id="cb12-67" data-line-number="67"><span class="co">#&gt; $ rnc_resolution_date         &lt;date&gt; NA, NA, NA, NA, NA, NA, NA, NA, N...</span></a>
<a class="sourceLine" id="cb12-68" data-line-number="68"><span class="co">#&gt; $ violation_severity          &lt;int&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0...</span></a></code></pre></div>
</div>
<div id="spatial-data" class="section level3">
<h3>Spatial data</h3>
<p><code>echor</code> can also return spatial data frames known as simple features (<a href="https://r-spatial.github.io/sf/" class="uri">https://r-spatial.github.io/sf/</a>), to facilitate creation of maps. Both <code>echoAirGetFacilityInfo</code> and <code>echoWaterGetFacilityInfo</code> include arguments to return simple feature dataframes.</p>
<p>Using <code>sf</code>, <code>ggmap</code>, and the current development version of <code>ggplot2</code> (<code>devtools::install_github(&quot;tidyverse/ggplot2&quot;)</code>), we can quickly create a map of downloaded data.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1">## Sample code only,</a>
<a class="sourceLine" id="cb13-2" data-line-number="2">## This example requires the development</a>
<a class="sourceLine" id="cb13-3" data-line-number="3">## version of ggplot2 with support for</a>
<a class="sourceLine" id="cb13-4" data-line-number="4">## geom_sf()</a>
<a class="sourceLine" id="cb13-5" data-line-number="5"></a>
<a class="sourceLine" id="cb13-6" data-line-number="6"><span class="kw">library</span>(ggplot2)</a>
<a class="sourceLine" id="cb13-7" data-line-number="7"><span class="kw">library</span>(ggmap)</a>
<a class="sourceLine" id="cb13-8" data-line-number="8"><span class="kw">library</span>(dplyr)</a>
<a class="sourceLine" id="cb13-9" data-line-number="9"><span class="kw">library</span>(purrr)</a>
<a class="sourceLine" id="cb13-10" data-line-number="10"><span class="kw">library</span>(sf)</a>
<a class="sourceLine" id="cb13-11" data-line-number="11"><span class="kw">library</span>(ggrepel)</a>
<a class="sourceLine" id="cb13-12" data-line-number="12"></a>
<a class="sourceLine" id="cb13-13" data-line-number="13">## Download data as a simple feature</a>
<a class="sourceLine" id="cb13-14" data-line-number="14">df &lt;-<span class="st"> </span><span class="kw">echoWaterGetFacilityInfo</span>(<span class="dt">xmin =</span> <span class="st">'-96.407563'</span>, <span class="dt">ymin =</span> <span class="st">'30.554395'</span>,</a>
<a class="sourceLine" id="cb13-15" data-line-number="15">                                        <span class="dt">xmax =</span> <span class="st">'-96.25947'</span>, <span class="dt">ymax =</span> <span class="st">'30.751984'</span>,</a>
<a class="sourceLine" id="cb13-16" data-line-number="16">                                        <span class="dt">output =</span> <span class="st">'sf'</span>)</a>
<a class="sourceLine" id="cb13-17" data-line-number="17">## Download a basemap with gg_map</a>
<a class="sourceLine" id="cb13-18" data-line-number="18">collegestation &lt;-<span class="st"> </span><span class="kw">get_map</span>(<span class="dt">location =</span> <span class="kw">c</span>(<span class="op">-</span><span class="fl">96.387509</span>, <span class="fl">30.583572</span>,</a>
<a class="sourceLine" id="cb13-19" data-line-number="19">                                       <span class="fl">-96.281422</span>, <span class="fl">30.640008</span>), </a>
<a class="sourceLine" id="cb13-20" data-line-number="20">                          <span class="dt">zoom =</span> <span class="dv">14</span>, <span class="dt">maptype =</span> <span class="st">&quot;toner&quot;</span>)</a>
<a class="sourceLine" id="cb13-21" data-line-number="21"></a>
<a class="sourceLine" id="cb13-22" data-line-number="22">## Use coordinates to create label locations</a>
<a class="sourceLine" id="cb13-23" data-line-number="23">df &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb13-24" data-line-number="24"><span class="st">  </span><span class="kw">mutate</span>(</a>
<a class="sourceLine" id="cb13-25" data-line-number="25">    <span class="dt">coords =</span> <span class="kw">map</span>(geometry, st_coordinates),</a>
<a class="sourceLine" id="cb13-26" data-line-number="26">    <span class="dt">coords_x =</span> <span class="kw">map_dbl</span>(coords, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb13-27" data-line-number="27">    <span class="dt">coords_y =</span> <span class="kw">map_dbl</span>(coords, <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb13-28" data-line-number="28">  )</a>
<a class="sourceLine" id="cb13-29" data-line-number="29"></a>
<a class="sourceLine" id="cb13-30" data-line-number="30">## Make the map</a>
<a class="sourceLine" id="cb13-31" data-line-number="31"><span class="kw">ggmap</span>(collegestation) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb13-32" data-line-number="32"><span class="st">  </span><span class="kw">geom_sf</span>(<span class="dt">data =</span> df, <span class="dt">inherit.aes =</span> <span class="ot">FALSE</span>, <span class="dt">shape =</span> <span class="dv">21</span>, </a>
<a class="sourceLine" id="cb13-33" data-line-number="33">          <span class="dt">color =</span> <span class="st">&quot;darkred&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;darkred&quot;</span>, </a>
<a class="sourceLine" id="cb13-34" data-line-number="34">          <span class="dt">size =</span> <span class="dv">2</span>, <span class="dt">alpha =</span> <span class="fl">0.25</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb13-35" data-line-number="35"><span class="st">  </span><span class="kw">geom_label_repel</span>(<span class="dt">data =</span> df, <span class="kw">aes</span>(<span class="dt">x =</span> coords_x, <span class="dt">y =</span> coords_y, <span class="dt">label =</span> SourceID),</a>
<a class="sourceLine" id="cb13-36" data-line-number="36">                   <span class="dt">point.padding =</span> <span class="fl">.5</span>, <span class="dt">min.segment.length =</span> <span class="fl">0.1</span>,</a>
<a class="sourceLine" id="cb13-37" data-line-number="37">                   <span class="dt">size =</span> <span class="dv">2</span>, <span class="dt">color =</span> <span class="st">&quot;dodgerblue&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb13-38" data-line-number="38"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Longitude&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Latitude&quot;</span>, </a>
<a class="sourceLine" id="cb13-39" data-line-number="39">       <span class="dt">title =</span> <span class="st">&quot;NPDES permits near Texas A&amp;M&quot;</span>,</a>
<a class="sourceLine" id="cb13-40" data-line-number="40">       <span class="dt">caption =</span> <span class="st">&quot;Source: EPA ECHO database&quot;</span>)</a></code></pre></div>
</div>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
